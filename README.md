# CAP3 Windows Wrapper (cap3-win-wrapper)

The CAP3 Windows Wrapper (cap3-win-wrapper) is designed for the assembly of
plasmid sequences from a series of .ab1 files on Windows. cap3-win-wrapper
generates a `bash` script that can be invoked in 32-bit Cygwin for Windows
to run the CAP3 executable with the correct command-line arguments.

## Prerequisites:

1. The 32-bit version of Cygwin (https://cygwin.com/). The 64-bit version will
not work. To obtain the 32-bit version, follow the instructions available here:
https://cygwin.com/install.html.

2. A copy of the CAP3 binary, for the 32-bit version of Cygwin:
https://faculty.sites.iastate.edu/xqhuang/cap3-assembly-program.

## How to Assemble Plasmid Sequences:

1. Prepare the .ab1 files using an appropriate directory organization. The
program is intended to be used with one sequencing directory where all your
.ab1 files are located, organized by run. For example:
```
C:\sequencing\run1\seq1.ab1
C:\sequencing\run2\seq1.ab1
C:\sequencing\run2\seq2.ab1
```

2. Write a tab-separated design file for the wrapper program. The first field
is the name of the contig to be assembled, and each subsequent field is
a sequence read to be added to the assembly, in the format RUNNAME_SAMPLENAME.
The read fields are broken at the first underscore, so subsequent underscores
are allowed if needed to unambiquously distinguish .ab1 files in the sequencing
directory. The program will search for .ab1 files using wildcards:
```
*RUNNAME*\*SAMPLENAME*.ab1
```
Therefore, it is important to add enough information to RUNNAME and SAMPLENAME
to unambiguously identify each .ab1 file. See the Tests section below for an
example of a design file.

3. Run cap3-win-wrapper.py (see Program Usage and Tests sections below).

4. If a `bash` script is requested, open the Cygwin emulator and run the
`bash` script to call `cap3` and assemble the sequencing reads.

## Tests:



## Program Usage:

```

usage: cap3-win-wrapper.py [-h] [-c PATH PATH] [-t [TEMPLATE ...]]
                           FILE.tsv PATH/TO/READS

Wrapper for the CAP3 program on Windows. Converts Applied Biosystems .ab1
files to .fa and .qual files and generates a CAP3 executable that can be run
using Cygwin 32-bit for Windows.

positional arguments:
  FILE.tsv              Tab-separated file containing the template names and
                        sequencing reads in the format RUNNAME_SAMPLENAME.
                        SAMPLENAME but not RUNNAME can contain the underscore
                        character. Lines beginning with # are ignored.
                        Optionally, a subset of the read can be selected using
                        the format RUNNAME_SAMPLENAME:FIRST-LAST, using a
                        1-indexed range FIRST-LAST.
  PATH/TO/READS         Parent path of the run directories containing .ab1
                        reads. Sequencing reads must be named
                        *RUNNAME*/*SAMPLENAME*.ab1, so no other folders or
                        files in readpath may contain RUNNAME and SAMPLENAME,
                        respectively.

optional arguments:
  -h, --help            show this help message and exit
  -c PATH PATH, --cap3run PATH PATH
                        Name of the CAP3 .sh executable to be generated by
                        this program, followed by a space and the location of
                        the CAP3 executable in Cygwin format without any
                        executable extensions, example: MYCAP.sh
                        /cygdrive/c/CAP3/cap3
  -t [TEMPLATE ...], --templates [TEMPLATE ...]
                        List of templates to assemble. Omit to assemble all
                        templates.

```


